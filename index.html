<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>여행 정산 | Trip Splitter</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <div class="wrap title">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>여행 정산 · Trip Splitter</h1>
        <div class="sub">각자 사용액과 결제자를 입력하면, 누가 누구에게 얼마나 송금하면 되는지 자동 계산합니다.</div>
      </div>
      <div style="flex:1"></div>
      <button id="resetBtn" class="btn warn" title="모든 데이터를 초기화합니다">초기화</button>
    </div>
  </header>

  <main class="wrap">
    <div class="grid">
      <section class="card" aria-labelledby="peopleTitle">
        <h2 id="peopleTitle">👥 참가자</h2>
        <div class="row">
          <div>
            <label for="participantName">이름</label>
            <input id="participantName" type="text" placeholder="예: 지민" />
          </div>
          <div style="flex:0 0 auto">
            <label>&nbsp;</label>
            <button id="addParticipantBtn" class="btn">추가</button>
          </div>
        </div>
        <div id="participantsList" class="chips" style="margin-top:10px"></div>
        <div class="footer-note">Tip: 참가자를 먼저 추가한 뒤, 지출 항목을 입력하세요.</div>

        <div class="separator"></div>
        <h2>🧾 지출 추가</h2>
        <div class="row">
          <div>
            <label for="expTitle">항목명</label>
            <input id="expTitle" type="text" placeholder="예: 점심 / 택시 / 입장료" />
          </div>
          <div>
            <label for="expAmount">금액 (원)</label>
            <input id="expAmount" type="number" inputmode="decimal" min="0" step="1" placeholder="예: 54000" />
          </div>
        </div>
        <div class="row">
          <div>
            <label for="expPayer">결제자</label>
            <select id="expPayer"></select>
          </div>
          <div>
            <label>참여자</label>
            <div id="beneficiariesBox" class="chips"></div>
            <div class="row" style="margin-top:6px">
              <button id="selectAllBeneficiaries" class="btn small">전체 선택</button>
              <button id="clearAllBeneficiaries" class="btn small">전체 해제</button>
            </div>
          </div>
        </div>
        <!-- 분배 방식 -->
        <div class="row" style="margin-top:8px">
          <label><input type="radio" name="splitMode" id="splitEqual" value="equal" checked> 균등 분배</label>
          <label><input type="radio" name="splitMode" id="splitCustom" value="custom"> 개별 금액</label>
        </div>
        <div id="customShares" class="custom-shares"></div>
        <div class="row" style="margin-top:8px">
          <div style="flex:1 1 auto"></div>
          <button id="addExpenseBtn" class="btn primary">지출 추가</button>
          <button id="cancelEditBtn" class="btn" style="display:none">편집 취소</button>
        </div>
        <div class="footer-note">동일 항목을 여러 명이 나눠 썼다면 ‘참여자’에서 해당 인원만 선택하세요. 인원수로 균등 분배됩니다.</div>
      </section>

      <section class="card" aria-labelledby="resultTitle">
        <h2 id="resultTitle">📊 정산 결과</h2>
        <div id="balances"></div>
        <div class="separator"></div>
        <div id="settlements"></div>
        <div class="separator"></div>
        <div class="row">
          <button id="exportBtn" class="btn">데이터 내보내기 (JSON)</button>
          <label class="btn" for="importFile" style="cursor:pointer">불러오기<input id="importFile" type="file" accept="application/json" style="display:none"/></label>
        </div>
        <div class="footer-note">모든 계산은 원(₩) 단위로 반올림합니다. 실제 송금 전 금액을 서로 확인하세요.</div>
      </section>
    </div>

    <section class="card" style="margin-top:16px">
      <h2>📚 지출 목록</h2>
      <div class="footer-note" id="expensesHint">아직 지출이 없습니다. 위 폼에서 항목을 추가하세요.</div>
      <div style="overflow:auto">
        <table id="expensesTable" style="min-width:740px; display:none">
          <thead>
            <tr>
              <th style="width:28%">항목</th>
              <th class="right" style="width:12%">금액</th>
              <th style="width:14%">결제자</th>
              <th>참여자</th>
              <th class="right" style="width:16%">1인분</th>
              <th style="width:130px">동작</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <details id="testPanel" class="card">
      <summary>🧪 개발용 테스트 (열어서 결과 확인)</summary>
      <div id="testLog">테스트 실행 전…</div>
    </details>

  </main>

  <script src="app.js"></script>
</body>
</html>
